#!/bin/bash

message_file="$1" 
message=$(cat "$message_file")

current_branch=$(git rev-parse --abbrev-ref HEAD)
ticket_pattern='FRONTEND-[0-9]+'

COMMITFORMAT="(feat|fix|update|dev|doc)"
default_pattern="^($COMMITFORMAT: )"


if [[ ! $message =~ $default_pattern ]]; then 
  echo 'ğŸš¨ Git ì»¨ë²¤ì…˜ì„ ì¤€ìˆ˜í•´ì£¼ì„¸ìš”! ğŸ‘®'
  echo ''
  echo 'ğŸƒ      ğŸš“ğŸ’¨ğŸ’¨'
  osascript -e 'display notification "ğŸš¨ Git ì»¨ë²¤ì…˜ì„ ì¤€ìˆ˜í•´ì£¼ì„¸ìš”! ğŸ‘®" with title "ì»¨ë²¤ì…˜ ê²½ê³ "'
  exit 1
fi

if [[ ! $message =~ \[$ticket_pattern\]$ ]]; then
  if [[ $current_branch =~ $ticket_pattern ]]; then
    target_ticket="

[${BASH_REMATCH[0]}]"
  fi
fi

exit 0